<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upload Projects</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body { background:#1e1e1e; color:#ddd; font-family:"Segoe UI",sans-serif; }
    main { padding:40px; max-width:800px; margin:auto; }
    input, textarea { width:100%; padding:8px; margin-top:4px; border-radius:6px; border:none; }
    input[type=file] { background:#2d2d30; color:#ccc; }
    #fileList { margin-top:20px; background:#2d2d30; padding:10px; border-radius:8px; }
    .file-item { display:flex; justify-content:space-between; align-items:center; padding:6px 10px; border-bottom:1px solid #3a3a3a; }
    .file-item:last-child { border-bottom:none; }
    .file-item button { background:#c23c3c; border:none; color:white; padding:4px 8px; border-radius:4px; cursor:pointer; }
    .file-item button:hover { background:#ff5555; }
  </style>
</head>
<body>
  <main>
    <h1>Upload or Edit a Project</h1>

    <label>Project Name:</label>
    <input type="text" id="projName" placeholder="My Cool Project" />

    <label>Description:</label>
    <textarea id="projDesc" rows="4" placeholder="Short description..."></textarea>

    <label>Upload Files or Folders:</label>
    <input type="file" id="projFiles" webkitdirectory multiple />
    <input type="file" id="singleFiles" multiple style="margin-top:8px;" />

    <div id="fileList"></div>

    <button id="saveProject" style="margin-top:20px;">ðŸ’¾ Save Project</button>
  </main>

  <script>
    const fileList = document.getElementById("fileList");
    const folderInput = document.getElementById("projFiles");
    const fileInput = document.getElementById("singleFiles");
    const files = new Map(); // filename -> path

    function renderList() {
      fileList.innerHTML = "";
      if (files.size === 0) {
        fileList.innerHTML = "<p style='opacity:0.6;'>No files added yet.</p>";
        return;
      }
      files.forEach((path, name) => {
        const div = document.createElement("div");
        div.className = "file-item";
        div.innerHTML = `<span>${name}</span><button data-name="${name}">Delete</button>`;
        div.querySelector("button").addEventListener("click", e => {
          files.delete(e.target.dataset.name);
          renderList();
        });
        fileList.appendChild(div);
      });
    }

    function addFiles(fileListArray) {
      for (const file of fileListArray) {
        const name = file.webkitRelativePath || file.name;
        files.set(name, name);
      }
      renderList();
    }

    folderInput.addEventListener("change", e => addFiles(e.target.files));
    fileInput.addEventListener("change", e => addFiles(e.target.files));

    document.getElementById("saveProject").addEventListener("click", () => {
      const name = document.getElementById("projName").value.trim();
      const desc = document.getElementById("projDesc").value.trim();
      if (!name) return alert("Please enter a project name!");

      const projects = JSON.parse(localStorage.getItem("projects") || "[]");
      const project = {
        name,
        description: desc,
        files: Array.from(files.keys())
      };

      // remove old entry if same name
      const existingIndex = projects.findIndex(p => p.name === name);
      if (existingIndex >= 0) projects.splice(existingIndex, 1);

      projects.push(project);
      localStorage.setItem("projects", JSON.stringify(projects));

      alert("âœ… Project saved!");
      window.location.href = "index.html?key=my-secret-key";
    });

    renderList();
  </script>
</body>
</html>